<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="author" content="刀心の水">
<meta name="keywords" content=", visual, music, technology">
<meta name="description" content="Avoid returning handles to object internals to increase encapsulation, help const member functions act const, and minimize the creation of dangling handles.">


<meta property="og:description" content="Avoid returning handles to object internals to increase encapsulation, help const member functions act const, and minimize the creation of dangling handles.">
<meta property="og:type" content="article">
<meta property="og:title" content="Item-28 Avoid returning handles to object internals">
<meta name="twitter:title" content="Item-28 Avoid returning handles to object internals">
<meta property="og:url" content="https://nianze.tk/2018/02/avoid-return-handles-to-obejct-internals/">
<meta property="twitter:url" content="https://nianze.tk/2018/02/avoid-return-handles-to-obejct-internals/">
<meta property="og:site_name" content="刀心水敲字の地方">
<meta property="og:description" content="Avoid returning handles to object internals to increase encapsulation, help const member functions act const, and minimize the creation of dangling handles.">
<meta name="twitter:description" content="Avoid returning handles to object internals to increase encapsulation, help const member functions act const, and minimize the creation of dangling handles.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2018-02-16T12:26:14">
  
  
    <meta property="article:modified_time" content="2018-02-16T12:26:14">
  
  
  
    
      <meta property="article:section" content="technology">
    
      <meta property="article:section" content="coding">
    
  
  
    
      <meta property="article:tag" content="technique">
    
      <meta property="article:tag" content="cpp">
    
  


<meta name="twitter:card" content="summary">







  <meta property="og:image" content="https://nianze.tk/images/2018/2018-02/2018-02-16.gif">
  <meta property="twitter:image" content="https://nianze.tk/images/2018/2018-02/2018-02-16.gif">





  <meta property="og:image" content="https://nianze.tk/images/bw.JPG">
  <meta property="twitter:image" content="https://nianze.tk/images/bw.JPG">


    <title>Item-28 Avoid returning handles to object internals</title>

    <link rel="icon" href="https://nianze.tk/images/favicon.png">
    

    

    <link rel="canonical" href="https://nianze.tk/2018/02/avoid-return-handles-to-obejct-internals/">

    
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://nianze.tk/css/style-nnm2spxvve8onlujjlegkkytaehyadd4ksxc1hyzzq9a2wvtrgbljqyulomn.min.css" />
    
    
      
        <link rel="stylesheet" href="https://nianze.tk/css/main.css">
      
    
      
        <link rel="stylesheet" href="https://nianze.tk/css/loader.css">
      
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-71584380-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body id="container">
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fas fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://nianze.tk/">刀心水敲字の地方</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://nianze.tk/#about">
    
    
    
      
        <img class="header-picture" src="https://nianze.tk/images/bw.JPG" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://nianze.tk/#about">
          <img class="sidebar-profile-picture" src="https://nianze.tk/images/bw.JPG" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">刀心の水</h4>
        
          <h5 class="sidebar-profile-bio"><p>虚度廿余岁月浅，略识几行代码源。<br />
闲来随手快门按，怆然独把音韵弹。</p>

<p>Pain is inevitable.<br />
Suffering is optional.</p>
</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nianze.tk/">
    
      <i class="sidebar-button-icon fas fa-home" title='Home'></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nianze.tk/categories/thoughts">
    
      <i class="sidebar-button-icon fas fa-lightbulb" title='Thoughts'></i>
      
      <span class="sidebar-button-desc">Thoughts</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nianze.tk/categories/technology">
    
      <i class="sidebar-button-icon fas fa-code" title='Technology'></i>
      
      <span class="sidebar-button-desc">Technology</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nianze.tk/categories/music">
    
      <i class="sidebar-button-icon fas fa-music" title='Music'></i>
      
      <span class="sidebar-button-desc">Music</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nianze.tk/categories/visual">
    
      <i class="sidebar-button-icon fas fa-palette" title='Visual'></i>
      
      <span class="sidebar-button-desc">Visual</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nianze.tk/categories">
    
      <i class="sidebar-button-icon fas fa-bookmark" title='Categories'></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nianze.tk/tags">
    
      <i class="sidebar-button-icon fas fa-tags" title='Tags'></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nianze.tk/archives">
    
      <i class="sidebar-button-icon fas fa-archive" title='Archives'></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nianze.tk/about">
    
      <i class="sidebar-button-icon fas fa-user" title='About'></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/nianze" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fab fa-linkedin" title='LinkedIn'></i>
      
      <span class="sidebar-button-desc">LinkedIn</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/Nianze" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fab fa-github" title='Github'></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.flickr.com/photos/129774362@N07/" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fab fa-flickr", title='Flickr'></i>
      
      <span class="sidebar-button-desc">Flickr</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://instagram.com/eznain" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fab fa-instagram" title='Instagram'></i>
      
      <span class="sidebar-button-desc">Instagram</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.facebook.com/rym.lnz" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fab fa-facebook", title='Facebook'></i>
      
      <span class="sidebar-button-desc">Facebook</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/daoxinzhishui" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fab fa-twitter", title='Twitter'></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.youtube.com/user/daoxinzhishui" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fab fa-youtube", title='YouTube'></i>
      
      <span class="sidebar-button-desc">YouTube</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="mailto:daoxinzhishui@gmail.com" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fas fa-envelope", title='Email'></i>
      
      <span class="sidebar-button-desc">Email</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://nianze.tk/post/index.xml">
    
      <i class="sidebar-button-icon fas fa-rss-square", title='RSS'></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Item-28 Avoid returning handles to object internals
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2018-02-16T12:26:14-05:00">
        
  February 16, 2018

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://nianze.tk/categories/technology">technology</a>, 
    
      <a class="category-link" href="https://nianze.tk/categories/coding">coding</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p>Avoid returning handles to object internals to increase encapsulation, help <code>const</code> member functions act <code>const</code>, and minimize the creation of dangling handles.</p>

<p>References, pointers, and iterators are all <em>handlers</em> (ways to get at other objects), and returning a handle to an object&rsquo;s internals always runs the risk of</p>

<ol>
<li>compromising an object&rsquo;s encapsulation</li>
<li>making <code>const</code> member functions act like non-<code>const</code> ones, allowing an object&rsquo;s state to be modified</li>
<li>leading to dangling handles</li>
</ol>

<p>To see how handlers result in these resks, let&rsquo;s see an example.<br />
Suppose we&rsquo;re working with a rectangle class, represented by its upper left corner and lower right corner. To keep a <code>Rectangle</code> object small, we decide that the corner points should be stored in an auxiliary struct that the <code>Rectangle</code> points to:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Point</span> {  <span style="color:#75715e">// class representing points
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
    Point(<span style="color:#66d9ef">int</span> x, <span style="color:#66d9ef">int</span> y);
    ...
    <span style="color:#66d9ef">void</span> setX(<span style="color:#66d9ef">int</span> newVal);
    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setY</span>(<span style="color:#66d9ef">int</span> newVal);
    ...
};
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">RectData</span> {  <span style="color:#75715e">// Rectangle corner point data
</span><span style="color:#75715e"></span>    Point ulhc;    <span style="color:#75715e">// &#34;upper left-hand corner&#34;
</span><span style="color:#75715e"></span>    Point lrhc;    <span style="color:#75715e">// &#34;lower right-hand corner&#34;
</span><span style="color:#75715e"></span>}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Rectangle</span> {
<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
    Point<span style="color:#f92672">&amp;</span> upperLeft() <span style="color:#66d9ef">const</span> { <span style="color:#66d9ef">return</span> pData<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>ulhc; }
    Point<span style="color:#f92672">&amp;</span> lowerRight() <span style="color:#66d9ef">const</span> { <span style="color:#66d9ef">return</span> pData<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>lrhc; }
    ...
<span style="color:#66d9ef">private</span><span style="color:#f92672">:</span>
    std<span style="color:#f92672">:</span><span style="color:#f92672">:</span>tr1<span style="color:#f92672">:</span><span style="color:#f92672">:</span>shared_ptr<span style="color:#f92672">&lt;</span>RectData<span style="color:#f92672">&gt;</span> pData; <span style="color:#75715e">// see item 13 for tr1::shared_ptr
</span><span style="color:#75715e"></span>    ...
};
</code></pre></div>
<p>As item 20 suggests that  passing user-defined types by reference is typically more efficient than passing them by value, the two public member functions return references to the underlying <code>Point</code> ojects. Yet this design is wrong, for it&rsquo;s self-contradictory:</p>

<ul>
<li>on the one side, the two member functions are declared <code>const</code>, indicating read-only access level of the point they return</li>

<li><p>on the other side, returning handles to private internal data lets callers be able to modify that internal data:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">Point <span style="color:#a6e22e">coord1</span>(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>);
Point <span style="color:#a6e22e">coord3</span>(<span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">100</span>);
<span style="color:#66d9ef">const</span> Rectangle <span style="color:#a6e22e">rec</span>(coord1, coord2); <span style="color:#75715e">// rec is a const rectangle from (0,0) to (100,100)
</span><span style="color:#75715e"></span>rec.upperLeft().setX(<span style="color:#ae81ff">50</span>); <span style="color:#75715e">// now (50,0) to (100,100)
</span></code></pre></div></li>
</ul>

<p>Apparently, by returning handles to the <em>private</em> <code>ulhc</code> and <code>lrhc</code> through the <em>public</em> member functions <code>upperLeft</code> and <code>lowerRight</code>, the overall access level of data member goes to <code>public</code>, and the encapsulation decreases. This makes the risk 1 above.</p>

<p>The second risk comes from the fact that if a <code>const</code> member function returns a reference (or any other handles) to data associated with an object that is stored outside the object itself, the caller of the function can modify that data due to its fallout of the limitation of bitwise constness (item 3).</p>

<p>You may think the two risks above may be eliminated by applying <code>const</code> to the return types:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Rectangle</span> {
<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
    ...
    <span style="color:#66d9ef">const</span> Point<span style="color:#f92672">&amp;</span> upperLeft() <span style="color:#66d9ef">const</span> { <span style="color:#66d9ef">return</span> pData<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>ulhc; }
    <span style="color:#66d9ef">const</span> Point<span style="color:#f92672">&amp;</span> lowerRight() <span style="color:#66d9ef">const</span> { <span style="color:#66d9ef">return</span> pData<span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span>lrhc; }
    ...
};
</code></pre></div>
<p>With this altered design, the 2 problems above are indeed solved. Even so, the dangling handles in risk 3 are still possible.</p>

<blockquote>
<p>Dangling handles: handles that refer to parts of objects that don&rsquo;t exist any longer.</p>
</blockquote>

<p>In fact, function return values are the most common source of dangling handles. Consider a function that returns the bounding box for a GUI object in the form of a rectangle:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GUIObject</span> {...};
<span style="color:#66d9ef">const</span> Rectangle <span style="color:#a6e22e">boundingBox</span>(<span style="color:#66d9ef">const</span> GUIObject<span style="color:#f92672">&amp;</span> obj); <span style="color:#75715e">// returns a rectangle by value; see item 3 for why return type is const
</span></code></pre></div>
<p>If client use this function like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp">GUIObject <span style="color:#f92672">*</span>pgo;  <span style="color:#75715e">// make pgo point to some GUIObject
</span><span style="color:#75715e"></span>...
<span style="color:#66d9ef">const</span> Point <span style="color:#f92672">*</span>pUpperLeft <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>(boundingBox(<span style="color:#f92672">*</span>pgo).upperLeft()); <span style="color:#75715e">// get a ptr to the upper left point of its bounding box
</span></code></pre></div>
<p>This is a good example for dangling handle. The call to <code>boundingBox</code> will return a new, temporary <code>Rectangle</code> object. Let&rsquo;s call it <em>temp</em>. <code>upperLeft</code> will then be called on <em>temp</em>, and that call will return a reference to an internal part of <em>temp</em> (i.e., the upperLeft corner point), to which <code>pUpperLeft</code> will then point. The tragedy comes at the end of the statement, when <code>boundongBox</code>&rsquo;s return value <em>temp</em> is destroyed, and then it indirectly leads to the destruction of <em>temp</em>&rsquo;s upperLeft corner point, leaving <code>pUpperLeft</code> pointing to an object that no longer exists.</p>

<p>As long as a handle is being returned, we run the risk that the handle will outlive the object it refers to. But this doesn&rsquo;t mean we should <em>never</em> have a member function that returns a handle. Sometimes we have to - an exception is <code>operator[]</code> in <code>string</code> and <code>vector</code>, which works by returning references to the data in the containers (item 3), and that data will be destroyed when the containers themselves are.</p>

<blockquote>
<p>P.S.: by the way, we generally think of an object&rsquo;s &ldquo;internals&rdquo; as its data members, but member functions not accessible to the general public (<code>private</code> and <code>protected</code> ones) are part of an object&rsquo;s internals, too. Thus it&rsquo;s important not to return handles to them (i.e., never have a member function return a pointer to a less accessible member function), otherwise the access level will be that of the more accessible function, just like how the risk 1 shows us.</p>
</blockquote>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://nianze.tk/tags/technique/">technique</a>

  <a class="tag tag--primary tag--small" href="https://nianze.tk/tags/cpp/">cpp</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://nianze.tk/2018/02/strive-for-exception-safe-code/" data-tooltip="Item-29 Strive for exception-safe code">
              
                  <i class="fas fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://nianze.tk/2018/02/minimize-casting/" data-tooltip="Item-27 Minimize_casting">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fas fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fas fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://nianze.tk/2018/02/avoid-return-handles-to-obejct-internals/">
              <i class="fab fa-facebook-f"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://nianze.tk/2018/02/avoid-return-handles-to-obejct-internals/">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://nianze.tk/2018/02/avoid-return-handles-to-obejct-internals/">
              <i class="fab fa-google-plus-g"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#utteranc_thread" data-tooltip="Comments">
            <i class="fas fa-comment-dots"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
            <i class="fas fa-arrow-up"></i>
        
          </a>
      </li>
    </ul>
  
</div>

            
              
                <div id="utteranc_thread">
  <script src="https://utteranc.es/client.js"
    repo= "Nianze/personal-site-comments"
    issue-term="pathname"
    theme="github-light"
    label="✨comment 💬"
    crossorigin="anonymous"
    async>
  </script>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 刀心の水. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://nianze.tk/2018/02/strive-for-exception-safe-code/" data-tooltip="Item-29 Strive for exception-safe code">
              
                  <i class="fas fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://nianze.tk/2018/02/minimize-casting/" data-tooltip="Item-27 Minimize_casting">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fas fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fas fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://nianze.tk/2018/02/avoid-return-handles-to-obejct-internals/">
              <i class="fab fa-facebook-f"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://nianze.tk/2018/02/avoid-return-handles-to-obejct-internals/">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://nianze.tk/2018/02/avoid-return-handles-to-obejct-internals/">
              <i class="fab fa-google-plus-g"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#utteranc_thread" data-tooltip="Comments">
            <i class="fas fa-comment-dots"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
            <i class="fas fa-arrow-up"></i>
        
          </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fas fa-times"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fnianze.tk%2F2018%2F02%2Favoid-return-handles-to-obejct-internals%2F">
          <i class="fa fa-facebook-f"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fnianze.tk%2F2018%2F02%2Favoid-return-handles-to-obejct-internals%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https%3A%2F%2Fnianze.tk%2F2018%2F02%2Favoid-return-handles-to-obejct-internals%2F">
          <i class="fa fa-google-plus-g"></i><span>Share on Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fas fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://nianze.tk/images/bw.JPG" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">刀心の水</h4>
    
      <div id="about-card-bio"><p>虚度廿余岁月浅，略识几行代码源。<br />
闲来随手快门按，怆然独把音韵弹。</p>

<p>Pain is inevitable.<br />
Suffering is optional.</p>
</div>
    
    
      <div id="about-card-job">
        <i class="fas fa-laptop-code"></i>
        <br/>
        Developer
      </div>
    
    
      <div id="about-card-location">
        <i class="fas fa-map-marked-alt"></i>
        <br/>
        New York
      </div>
    
  </div>
</div>

    

    
  
    
    <div id="cover" style="background-image:url('https://nianze.tk/images/road.JPG');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/3.2.0/imagesloaded.pkgd.min.js"></script>


<script src="https://nianze.tk/js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js"></script>


  
    <script src="https://nianze.tk/js/loader.js"></script>
  

<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>





    
  </body>
</html>

